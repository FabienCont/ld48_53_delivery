[gd_scene load_steps=26 format=3 uid="uid://boxlgobc2bmf1"]

[ext_resource type="Script" path="res://scripts/ally.gd" id="1_fkmo4"]
[ext_resource type="Script" path="res://ressources/DisplayDamageHurtEffectResource.gd" id="2_bho8y"]
[ext_resource type="PackedScene" uid="uid://drqndqsdbxxc7" path="res://components/HurtboxComponent.tscn" id="2_wolpn"]
[ext_resource type="PackedScene" uid="uid://beiqnyl0bmd58" path="res://levels/props/money.tscn" id="3_emxrf"]
[ext_resource type="PackedScene" uid="uid://donmb7syeemi1" path="res://components/HealthComponent.tscn" id="3_lbnhk"]
[ext_resource type="ArrayMesh" uid="uid://d26nf0bb7q6fc" path="res://levels/props/cart.obj" id="3_lfvrd"]
[ext_resource type="PackedScene" uid="uid://chpsfjftfdckn" path="res://components/LifebarComponent.tscn" id="4_s2l8j"]

[sub_resource type="BoxShape3D" id="BoxShape3D_8ntli"]
size = Vector3(1.5, 0.75, 1.5)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_0y6r0"]
albedo_color = Color(0.490196, 0.486275, 0, 1)

[sub_resource type="PlaneMesh" id="PlaneMesh_likg2"]
size = Vector2(1, 1.3)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_sre4l"]
albedo_color = Color(0.3795, 0.456225, 0.55, 1)

[sub_resource type="FastNoiseLite" id="FastNoiseLite_8dlvn"]
seed = 1

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_twln4"]
width = 1024
noise = SubResource("FastNoiseLite_8dlvn")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_0mkts"]
albedo_color = Color(0.521569, 0.521569, 0.521569, 1)
albedo_texture = SubResource("NoiseTexture2D_twln4")

[sub_resource type="CylinderMesh" id="CylinderMesh_cbjgk"]
top_radius = 0.2
bottom_radius = 0.2
height = 0.2

[sub_resource type="Animation" id="Animation_0vfbh"]
resource_name = "drive"
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("MeshInstance3D4:rotation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(0, 0, 1.5708), Vector3(6.28319, 0, 1.5708)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("MeshInstance3D5:rotation")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(0, 0, 1.5708), Vector3(6.28319, 0, 1.5708)]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("MeshInstance3D6:rotation")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(0, 0, 1.5708), Vector3(6.28319, 0, 1.5708)]
}
tracks/3/type = "value"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("MeshInstance3D3:rotation")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(0, 0, 1.5708), Vector3(6.28319, 0, 1.5708)]
}

[sub_resource type="Animation" id="Animation_cyybh"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("MeshInstance3D3:rotation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0.156705, -3.12588, -1.59174)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_huvow"]
_data = {
"RESET": SubResource("Animation_cyybh"),
"roll": SubResource("Animation_0vfbh")
}

[sub_resource type="Animation" id="Animation_rj61x"]
resource_name = "idle"
length = 0.6
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("gold/MeshInstance3D7:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.3, 0.6),
"transitions": PackedFloat32Array(1, 1.36604, 1),
"update": 0,
"values": [Vector3(-0.245877, 0.212184, -0.0548583), Vector3(-0.246, 0.25, -0.055), Vector3(-0.245877, 0.212184, -0.0548583)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("gold:rotation")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.3, 0.6),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [Vector3(0, 0, 0), Vector3(0, 0, 0.0349066), Vector3(0, 0, 0)]
}
tracks/2/type = "position_3d"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("gold")
tracks/2/interp = 2
tracks/2/loop_wrap = true
tracks/2/keys = PackedFloat32Array(0.3, 1, 0, -0.05, 0, 0.6, 1, 0, 0, 0)
tracks/3/type = "value"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("gold/MeshInstance3D12:position")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(0.3, 0.6),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(0.24, 0.25, 0.4), Vector3(0.273193, 0.212184, 0.38821)]
}
tracks/4/type = "value"
tracks/4/imported = false
tracks/4/enabled = true
tracks/4/path = NodePath("gold/MeshInstance3D9:rotation")
tracks/4/interp = 1
tracks/4/loop_wrap = true
tracks/4/keys = {
"times": PackedFloat32Array(0.3, 0.6),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(-0.349066, 0.834267, -1.91986), Vector3(-1.72598e-07, 0.834267, -2.01411)]
}
tracks/5/type = "value"
tracks/5/imported = false
tracks/5/enabled = true
tracks/5/path = NodePath("gold/MeshInstance3D10:position")
tracks/5/interp = 1
tracks/5/loop_wrap = true
tracks/5/keys = {
"times": PackedFloat32Array(0.3, 0.6),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(0.3, 0.3, -0.374), Vector3(0.287578, 0.212184, -0.374086)]
}
tracks/6/type = "value"
tracks/6/imported = false
tracks/6/enabled = true
tracks/6/path = NodePath("gold/MeshInstance3D10:rotation")
tracks/6/interp = 1
tracks/6/loop_wrap = true
tracks/6/keys = {
"times": PackedFloat32Array(),
"transitions": PackedFloat32Array(),
"update": 0,
"values": []
}
tracks/7/type = "value"
tracks/7/imported = false
tracks/7/enabled = true
tracks/7/path = NodePath("cart/body:rotation")
tracks/7/interp = 1
tracks/7/loop_wrap = true
tracks/7/keys = {
"times": PackedFloat32Array(0.2, 0.4, 0.6),
"transitions": PackedFloat32Array(1.86607, 0.535887, 1),
"update": 0,
"values": [Vector3(0, 0, -0.0349066), Vector3(0, 0, 0.0349066), Vector3(0, 0, 3.72529e-09)]
}

[sub_resource type="Animation" id="Animation_5qcql"]
resource_name = "hurt"

[sub_resource type="AnimationLibrary" id="AnimationLibrary_e5u6g"]
_data = {
"hurt": SubResource("Animation_5qcql"),
"idle": SubResource("Animation_rj61x")
}

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_1jorq"]
animation = &"idle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_tlxvl"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_nxyes"]
states/Start/position = Vector2(180, 100)
states/idle/node = SubResource("AnimationNodeAnimation_1jorq")
states/idle/position = Vector2(435, 108)
transitions = ["Start", "idle", SubResource("AnimationNodeStateMachineTransition_tlxvl")]

[sub_resource type="AnimationNodeStateMachinePlayback" id="AnimationNodeStateMachinePlayback_q5mp6"]

[node name="AllyCharacterBody3D" type="CharacterBody3D" groups=["allies"]]
collision_layer = 257
collision_mask = 257
script = ExtResource("1_fkmo4")
hurt_effects = Array[Resource]([ExtResource("2_bho8y")])

[node name="HurtboxComponent" parent="." node_paths=PackedStringArray("health_component") instance=ExtResource("2_wolpn")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.283189, 0)
shape = SubResource("BoxShape3D_8ntli")
health_component = NodePath("../HealthComponent")

[node name="HealthComponent" parent="." instance=ExtResource("3_lbnhk")]

[node name="LifebarComponent" parent="." node_paths=PackedStringArray("healthComponent") instance=ExtResource("4_s2l8j")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.54783, 0)
visible = false
healthComponent = NodePath("../HealthComponent")

[node name="gold" type="Node3D" parent="."]
transform = Transform3D(0.999995, -0.0030891, 0, 0.0030891, 0.999995, 0, 0, 0, 1, 0, -0.00110543, 0)

[node name="MeshInstance3D7" parent="gold" instance=ExtResource("3_emxrf")]
transform = Transform3D(0.122803, -0.895247, 0.919115, 0.278766, 0.335256, -0.693433, 0.0354428, 0.465008, 2.26945, -0.245892, 0.21668, -0.0548751)
skeleton = NodePath("../..")

[node name="MeshInstance3D12" parent="gold" instance=ExtResource("3_emxrf")]
transform = Transform3D(-1.16091e-08, -0.920637, 1.2724, 0.291284, 0.166253, 0.68933, -0.0959216, 0.50486, 2.09328, 0.270256, 0.215531, 0.389253)
skeleton = NodePath("../..")

[node name="MeshInstance3D11" parent="gold" instance=ExtResource("3_emxrf")]
transform = Transform3D(-0.0225021, 1.09724, 0.00720271, -0.317201, -0.0778276, -0.00853904, -0.000966797, -0.00325275, 2.63398, 0.212076, 0.212184, -0.0548583)
skeleton = NodePath("../..")

[node name="MeshInstance3D8" parent="gold" instance=ExtResource("3_emxrf")]
transform = Transform3D(-0.0883596, 0.645053, 1.8852, -0.277027, -0.455984, 0, 0.0974471, -0.711394, 1.7094, -0.208823, 0.212184, 0.353518)
skeleton = NodePath("../..")

[node name="MeshInstance3D9" parent="gold" instance=ExtResource("3_emxrf")]
transform = Transform3D(-0.0804411, 0.657835, 1.8843, -0.277982, -0.447745, 0.0785995, 0.101502, -0.704893, 1.70858, -0.100692, 0.212184, -0.468234)
skeleton = NodePath("../..")

[node name="MeshInstance3D10" parent="gold" instance=ExtResource("3_emxrf")]
transform = Transform3D(-0.0883596, 0.645053, 1.8852, -0.277027, -0.455984, 0, 0.0974471, -0.711394, 1.7094, 0.288677, 0.219955, -0.374078)
skeleton = NodePath("../..")

[node name="cart" type="Node3D" parent="."]
transform = Transform3D(0.999946, -0.0104276, 0, 0.0104276, 0.999946, 0, 0, 0, 1, 0, 0, 0)

[node name="body" type="Node3D" parent="cart"]
transform = Transform3D(1, -0.000806119, 0, 0.000806119, 1, 0, 0, 0, 1, 0, 0, 0)

[node name="MeshInstance3D13" type="MeshInstance3D" parent="cart/body"]
transform = Transform3D(1, 4.65661e-09, 0, -4.65661e-09, 1, 0, 0, 0, 1, 8.14907e-10, 0.113923, 0)
material_override = SubResource("StandardMaterial3D_0y6r0")
mesh = SubResource("PlaneMesh_likg2")
skeleton = NodePath("../../..")

[node name="MeshInstance3D" type="MeshInstance3D" parent="cart/body"]
transform = Transform3D(0.5, 2.32831e-09, 0, -2.32831e-09, 0.5, 0, 0, 0, 0.5, -3.0268e-09, -0.283189, 0)
material_override = SubResource("StandardMaterial3D_sre4l")
mesh = ExtResource("3_lfvrd")
skeleton = NodePath("../../..")

[node name="wheels" type="Node3D" parent="cart"]
transform = Transform3D(0.999848, 0.0174524, 0, -0.0174524, 0.999848, 0, 0, 0, 1, 0, 0, 0)

[node name="MeshInstance3D3" type="MeshInstance3D" parent="cart/wheels"]
transform = Transform3D(0.0233904, -0.999606, -0.0155148, -0.98753, -0.0206855, -0.156064, 0.155682, 0.0189717, -0.987625, 0.773223, -0.650567, 0.576118)
material_override = SubResource("StandardMaterial3D_0mkts")
mesh = SubResource("CylinderMesh_cbjgk")
skeleton = NodePath("../../..")

[node name="MeshInstance3D4" type="MeshInstance3D" parent="cart/wheels"]
transform = Transform3D(-4.37114e-08, -1, 0, 0.0418755, -1.83044e-09, 0.999123, -0.999123, 4.3673e-08, 0.0418755, 0.744099, -0.700974, -0.697875)
material_override = SubResource("StandardMaterial3D_0mkts")
mesh = SubResource("CylinderMesh_cbjgk")
skeleton = NodePath("../../..")

[node name="MeshInstance3D5" type="MeshInstance3D" parent="cart/wheels"]
transform = Transform3D(-4.37114e-08, -1, 0, 0.0418755, -1.83044e-09, 0.999123, -0.999123, 4.3673e-08, 0.0418755, -0.769699, -0.700974, 0.618149)
material_override = SubResource("StandardMaterial3D_0mkts")
mesh = SubResource("CylinderMesh_cbjgk")
skeleton = NodePath("../../..")

[node name="MeshInstance3D6" type="MeshInstance3D" parent="cart/wheels"]
transform = Transform3D(-4.37114e-08, -1, 0, 0.0418755, -1.83044e-09, 0.999123, -0.999123, 4.3673e-08, 0.0418755, -0.769699, -0.700974, -0.697875)
material_override = SubResource("StandardMaterial3D_0mkts")
mesh = SubResource("CylinderMesh_cbjgk")
skeleton = NodePath("../../..")

[node name="AnimationPlayer" type="AnimationPlayer" parent="cart/wheels"]
libraries = {
"": SubResource("AnimationLibrary_huvow")
}

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
reset_on_save = false
libraries = {
"": SubResource("AnimationLibrary_e5u6g")
}

[node name="AnimationTree" type="AnimationTree" parent="."]
tree_root = SubResource("AnimationNodeStateMachine_nxyes")
anim_player = NodePath("../AnimationPlayer")
active = true
parameters/playback = SubResource("AnimationNodeStateMachinePlayback_q5mp6")
