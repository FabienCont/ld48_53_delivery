[gd_scene load_steps=18 format=3 uid="uid://bkv74b18figfa"]

[ext_resource type="Script" path="res://scripts/katana.gd" id="1_87fpx"]
[ext_resource type="PackedScene" uid="uid://c6d3xfvcu8km3" path="res://weapons/sword.glb" id="2_ekvaw"]

[sub_resource type="BoxShape3D" id="BoxShape3D_mvl4y"]
size = Vector3(0.1, 1.2, 0.3)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_dxkf2"]
albedo_color = Color(0.662745, 0.670588, 0.623529, 1)
metallic = 0.9
roughness = 0.1

[sub_resource type="BoxMesh" id="BoxMesh_rhjx0"]
material = SubResource("StandardMaterial3D_dxkf2")
size = Vector3(0.005, 0.05, 0.75)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_jvna8"]
points = PackedVector3Array(0.00318108, 0.0261364, 0.37682, -0.004, -0.027, -1, 0.003, -0.027, -1, -0.004, 0, 0.377, -0.004, 0.026, -1, 0.003, 0.026, -1, 0.00318108, -0.0268939, 0.37682, -0.0043932, 0.0261364, 0.37682)

[sub_resource type="Animation" id="Animation_igbia"]
resource_name = "attack"
length = 0.5
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Node3D:rotation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.3, 0.5),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 0,
"values": [Vector3(1.32645, 0, 0), Vector3(-2.0944, 0.785398, 0), Vector3(-1.5708, 0, 0), Vector3(1.32645, 0, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Node3D:position")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.1, 0.3, 0.5),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 0,
"values": [Vector3(0.2, 0.01, 0), Vector3(-0.4, -0.1, 0), Vector3(-0.7, -0.1, 0), Vector3(0.2, 0.01, 0)]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Node3D/MeshInstance3D3/MeshInstance3D2:rotation")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 0.1, 0.3, 0.5),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 0,
"values": [Vector3(0, 0, 0.349066), Vector3(1.5708, 1.0472, 0.698132), Vector3(1.5708, 1.0472, 0.698132), Vector3(0, 0, 0)]
}
tracks/3/type = "value"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("hand:rotation")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [Vector3(0, 0, 0), Vector3(-1.39626, -0.174533, 0), Vector3(0, 0, 0)]
}
tracks/4/type = "value"
tracks/4/imported = false
tracks/4/enabled = true
tracks/4/path = NodePath("hand:position")
tracks/4/interp = 1
tracks/4/loop_wrap = true
tracks/4/keys = {
"times": PackedFloat32Array(),
"transitions": PackedFloat32Array(),
"update": 0,
"values": []
}

[sub_resource type="Animation" id="Animation_0e3d3"]
resource_name = "attack_sword"
length = 0.4
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("hand:rotation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [Vector3(0, 0, 0), Vector3(-1.39626, -0.174533, 0), Vector3(0, 0, 0)]
}

[sub_resource type="Animation" id="Animation_fqvwb"]
resource_name = "idle"
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Node3D:rotation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5, 1),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [Vector3(1.32645, 0, 0), Vector3(1.22173, -0.349066, 0), Vector3(1.32645, 0, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Node3D:position")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.5, 1),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [Vector3(0.2, 0, 0), Vector3(0.2, 0, 0), Vector3(0.2, 0, 0)]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Node3D/MeshInstance3D3/MeshInstance3D2:rotation")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0, 0, 0.349066)]
}
tracks/3/type = "value"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("hand:position")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(0, 0.5, 1),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [Vector3(0, 0, 0), Vector3(0, 0.1, 0), Vector3(0, 0, 0)]
}
tracks/4/type = "value"
tracks/4/imported = false
tracks/4/enabled = true
tracks/4/path = NodePath("hand:rotation")
tracks/4/interp = 1
tracks/4/loop_wrap = true
tracks/4/keys = {
"times": PackedFloat32Array(0, 0.5, 1),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [Vector3(0, 0, 0), Vector3(0, 0, 0), Vector3(0, 0, 0)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_xul54"]
_data = {
"attack": SubResource("Animation_igbia"),
"attack_sword": SubResource("Animation_0e3d3"),
"idle": SubResource("Animation_fqvwb")
}

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_3fwpx"]
animation = &"attack_sword"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_4ogv8"]
animation = &"idle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_qwkj3"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_fljg8"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_pqrw5"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_pwjax"]
states/Start/position = Vector2(199, 100)
states/attack/node = SubResource("AnimationNodeAnimation_3fwpx")
states/attack/position = Vector2(573, 76)
states/idle/node = SubResource("AnimationNodeAnimation_4ogv8")
states/idle/position = Vector2(355, 76)
transitions = ["Start", "idle", SubResource("AnimationNodeStateMachineTransition_qwkj3"), "idle", "attack", SubResource("AnimationNodeStateMachineTransition_fljg8"), "attack", "idle", SubResource("AnimationNodeStateMachineTransition_pqrw5")]

[sub_resource type="AnimationNodeStateMachinePlayback" id="AnimationNodeStateMachinePlayback_0w63t"]

[node name="katana" type="Node3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.151759, 0)
script = ExtResource("1_87fpx")

[node name="hand" type="Node3D" parent="."]
transform = Transform3D(0.999999, 0, 0, 0, 1, 0, 0, 0, 0.999999, 0, 0.0419148, 0)

[node name="sword" parent="hand" instance=ExtResource("2_ekvaw")]

[node name="Area3D" type="Area3D" parent="hand"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.803239, 0)

[node name="CollisionShape3D" type="CollisionShape3D" parent="hand/Area3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.18153, 0)
shape = SubResource("BoxShape3D_mvl4y")

[node name="Node3D" type="Node3D" parent="."]
transform = Transform3D(0.989315, -0.139775, -0.0414426, 0, 0.284265, -0.958745, 0.145789, 0.948502, 0.281227, 0.2, 0, 0)
visible = false

[node name="MeshInstance3D3" type="Node3D" parent="Node3D"]

[node name="MeshInstance3D2" type="MeshInstance3D" parent="Node3D/MeshInstance3D3"]
transform = Transform3D(0.939693, -0.34202, 0, 0.34202, 0.939693, 0, 0, 0, 1, -0.211028, 0.0456919, -0.285987)
layers = 2
mesh = SubResource("BoxMesh_rhjx0")
skeleton = NodePath("../../../../..")

[node name="CSGPolygon3D" type="CSGPolygon3D" parent="Node3D/MeshInstance3D3"]
transform = Transform3D(-0.555836, -0.829731, -0.0509283, 0.826581, -0.545133, -0.13998, 0.0883833, -0.119902, 0.988845, -0.0510304, -0.13906, 0.0712033)
layers = 2
polygon = PackedVector2Array(0.1, 0, 0.3, 0.09, 0.17, 0.13)
depth = 1.46
smooth_faces = true
material = SubResource("StandardMaterial3D_dxkf2")

[node name="Area3D" type="Area3D" parent="Node3D/MeshInstance3D3"]
transform = Transform3D(0.87948, -0.44401, -0.171378, 0.464768, 0.878778, 0.108347, 0.102496, -0.174941, 0.979229, 0, 0, 0)

[node name="CollisionShape3D" type="CollisionShape3D" parent="Node3D/MeshInstance3D3/Area3D"]
transform = Transform3D(0.971189, -0.216275, -0.100084, 0.181548, 0.943513, -0.277177, 0.154377, 0.251021, 0.955593, -0.114933, 0.227945, -0.263026)
shape = SubResource("ConvexPolygonShape3D_jvna8")

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
"": SubResource("AnimationLibrary_xul54")
}

[node name="AnimationTree" type="AnimationTree" parent="."]
tree_root = SubResource("AnimationNodeStateMachine_pwjax")
anim_player = NodePath("../AnimationPlayer")
active = true
parameters/playback = SubResource("AnimationNodeStateMachinePlayback_0w63t")

[connection signal="body_entered" from="Node3D/MeshInstance3D3/Area3D" to="." method="_on_area_3d_body_entered"]
